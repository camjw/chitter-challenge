language: ruby
rvm: '2.5.0'

script:
  - mkdir -p spec && bundle exec rspec spec
  - bundle exec rake setup


before_install:
- sudo apt-get update -qq
- sudo apt-get install -qq postgresql-server-dev-9.3

before_script:
  - psql -c 'create database chitter_test;' -U postgres
  - psql -U postgres -tc "SELECT 1 FROM pg_database WHERE datname = 'my_db'" | grep -q 1 || psql -U postgres -c "CREATE DATABASE my_db"


services:
  - postgresql
